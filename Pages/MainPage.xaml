<?xml version="1.0" encoding="utf-8"?>
<ContentPage
  xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
  xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
  x:Class="UAUIngleza_plc.MainPage"
  Shell.FlyoutBehavior="Flyout"
  Title="UAU Ingleza"
>
  <Grid ColumnSpacing="0">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="4*" />
      <ColumnDefinition Width="3*" />
    </Grid.ColumnDefinitions>
    <!-- Coluna Esquerda: WebView da Câmera + Status de Conexão -->
    <Grid Grid.Column="0" RowSpacing="0">
      <Grid.RowDefinitions>
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>
      <!-- WebView da Câmera -->
      <Border Grid.Row="0" StrokeThickness="0">
        <WebView x:Name="CameraWebView" BackgroundColor="Black" />
      </Border>
    </Grid>
    <!-- Menu Lateral -->
    <Border Grid.Column="1" Background="#1a1a1a" StrokeThickness="2" Stroke="#2a2a2a">
      <VerticalStackLayout Spacing="10">
        <!-- Picker de Receitas -->
        <Picker
          x:Name="RecipePicker"
          ItemsSource="{Binding RecipeList}"
          ItemDisplayBinding="{Binding Name}"
          SelectedItem="{Binding SelectedRecipe, Mode=TwoWay}"
          Title="Selecione uma receita"
          BackgroundColor="#2a2a2a"
          TextColor="White"
          TitleColor="#888888"
          FontSize="12"
          FontAttributes="Bold"
          HeightRequest="50"
          Margin="0,8,0,8"
        ></Picker>
        <!-- Divisor -->
        <BoxView HeightRequest="1" Color="#3a3a3a" HorizontalOptions="Fill" Margin="0,5,0,5" />
        <!-- Grid de Contadores -->
        <Grid ColumnSpacing="8" RowSpacing="8">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>
          <!-- Caixas Boas -->
          <Border
            Grid.Column="0"
            Grid.Row="0"
            Background="#2a2a2a"
            Padding="8"
            StrokeThickness="1"
            Stroke="#3a3a3a"
            StrokeShape="RoundRectangle 8"
          >
            <VerticalStackLayout Spacing="3">
              <Label
                Text="CAIXAS BOAS"
                FontSize="8"
                FontAttributes="Bold"
                TextColor="#888888"
                HorizontalOptions="Center"
              />
              <Label
                Text="{Binding CaixasBoas}"
                FontSize="20"
                FontAttributes="Bold"
                HorizontalOptions="Center"
                TextColor="#4CAF50"
              />
            </VerticalStackLayout>
          </Border>
          <!-- Caixas Ruins -->
          <Border
            Grid.Column="1"
            Grid.Row="0"
            Background="#2a2a2a"
            Padding="8"
            StrokeThickness="1"
            Stroke="#3a3a3a"
            StrokeShape="RoundRectangle 8"
          >
            <VerticalStackLayout Spacing="3">
              <Label
                Text="CAIXAS RUINS"
                FontSize="8"
                FontAttributes="Bold"
                TextColor="#888888"
                HorizontalOptions="Center"
              />
              <Label
                Text="{Binding CaixasRejeitadas}"
                FontSize="20"
                FontAttributes="Bold"
                HorizontalOptions="Center"
                TextColor="#F44336"
              />
            </VerticalStackLayout>
          </Border>
          <!-- Total de Caixas -->
          <Border
            Grid.Column="0"
            Grid.Row="1"
            Grid.ColumnSpan="2"
            Background="#2a2a2a"
            Padding="10"
            StrokeThickness="1"
            Stroke="#3a3a3a"
            StrokeShape="RoundRectangle 8"
          >
            <VerticalStackLayout Spacing="3">
              <Label
                Text="TOTAL DE CAIXAS"
                FontSize="9"
                FontAttributes="Bold"
                TextColor="#888888"
                HorizontalOptions="Center"
              />
              <Label
                Text="{Binding TotalCaixas}"
                FontSize="22"
                FontAttributes="Bold"
                HorizontalOptions="Center"
                TextColor="{StaticResource Secondary}"
              />
            </VerticalStackLayout>
          </Border>
        </Grid>
        <Button
          Text="RESETAR CONTADOR"
          Clicked="ResetCount"
          BackgroundColor="#2a2a2a"
          TextColor="#FF9800"
          FontSize="11"
          FontAttributes="Bold"
          HeightRequest="45"
          CornerRadius="8"
          BorderWidth="1"
          BorderColor="#3a3a3a"
          Margin="0,0,0,45"
        />
        <!-- Status de Conexão -->
        <Grid Grid.Row="1" Background="#2a2a2a" Padding="12" ColumnSpacing="8">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <Border
            Grid.Column="0"
            WidthRequest="16"
            HeightRequest="16"
            StrokeThickness="2"
            Stroke="{Binding IsConnected, Converter={StaticResource BoolToColorConverter}}"
            StrokeShape="RoundRectangle 8"
            Background="{Binding IsConnected, Converter={StaticResource BoolToColorConverter}}"
            VerticalOptions="Center"
          >
            <Border.Shadow>
              <Shadow
                Brush="{Binding IsConnected, Converter={StaticResource BoolToColorConverter}}"
                Radius="8"
                Opacity="0.8"
              />
            </Border.Shadow>
          </Border>
          <Label
            Grid.Column="1"
            Text="{Binding IsConnected, Converter={StaticResource BoolToStatusTextConverter}}"
            FontSize="11"
            FontAttributes="Bold"
            TextColor="{Binding IsConnected, Converter={StaticResource BoolToColorConverter}}"
            VerticalOptions="Center"
          />
        </Grid>
      </VerticalStackLayout>
    </Border>
  </Grid>
</ContentPage>
